{"version":3,"sources":["App.tsx","reportWebVitals.ts","index.tsx"],"names":["recipesByComponent","Map","recipes","recipe","outputs","output","componentRecipes","get","id","asInput","asOutput","set","push","inputs","input","componentsRecipes","components","values","sort","a","b","localeCompare","App","useState","plans","setPlans","settings","setSettings","resources","setResources","newId","setNewId","newRate","setNewRate","displayFactor","setDisplayFactor","fractionDigits","setFractionalDigits","sankey","useRef","nodes","setNodes","links","setLinks","updatePlan","useCallback","plan","removePlan","delete","changeResourceSetting","newSettings","formatResourceRate","num","toFixed","useEffect","newResources","planQueue","filter","disabled","map","planId","implicit","i","shift","length","outputResource","external","usedBy","uses","setting","find","r","name","rate","outputRatio","amount","time","neededRate","inputResource","newNodes","newLinks","idMap","resourceId","color","randomColor","resource","link","source","target","value","className","type","onChange","e","Number","component","placeholder","onClick","ref","nodePadding","width","current","getBoundingClientRect","height","size","entries","reduce","acc","res","machine","use","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b7065c5a.chunk.js","sourcesContent":["import React, { FC, useCallback, useEffect, useRef, useState } from 'react';\nimport { Sankey } from 'react-vis';\nimport randomColor from 'randomcolor';\n\nimport 'react-vis/dist/style.css';\nimport recipes from './recipes.json';\n\nimport './App.css';\nimport { Recipe } from './Recipe';\n\ninterface ComponentRecipes {\n\tid: string;\n\tasInput: Recipe[];\n\tasOutput: Recipe[];\n}\n\ninterface Plan {\n\trate: number;\n\tdisabled: boolean;\n}\n\ninterface Resource {\n\trecipe: Recipe | null;\n\texternal: boolean;\n\timplicit: boolean;\n\tusedBy: Map<string, number>;\n\tuses: Map<string, number>;\n}\n\ninterface ResourceSetting {\n\texternal?: boolean;\n\trecipe?: string;\n}\n\ninterface PlanQueueItem extends Plan {\n\tid: string;\n\timplicit: boolean;\n}\n\ninterface Node {\n\tname: string;\n\tcolor?: string;\n\topacity?: number;\n\tkey?: string;\n}\n\ninterface Link {\n\tsource: number;\n\ttarget: number;\n\tvalue: number;\n\tcolor?: string;\n\topacity?: number;\n\tkey?: string;\n}\n\nconst recipesByComponent: Map<string, ComponentRecipes> = new Map();\nfor (const recipe of recipes) {\n\tfor (const output of recipe.outputs) {\n\t\tlet componentRecipes = recipesByComponent.get(output.id);\n\t\tif (!componentRecipes) {\n\t\t\tcomponentRecipes = { id: output.id, asInput: [], asOutput: [] };\n\t\t\trecipesByComponent.set(output.id, componentRecipes);\n\t\t}\n\t\tcomponentRecipes.asOutput.push(recipe as Recipe);\n\t}\n\tfor (const input of recipe.inputs) {\n\t\tlet componentsRecipes = recipesByComponent.get(input.id);\n\t\tif (!componentsRecipes) {\n\t\t\tcomponentsRecipes = { id: input.id, asInput: [], asOutput: [] };\n\t\t\trecipesByComponent.set(input.id, componentsRecipes);\n\t\t}\n\t\tcomponentsRecipes.asInput.push(recipe as Recipe);\n\t}\n}\n\nconst components = [...recipesByComponent.values()].sort((a, b) => a.id.localeCompare(b.id));\n\nconst App: FC = () => {\n\tconst [plans, setPlans] = useState<Map<string, Plan>>(new Map());\n\tconst [settings, setSettings] = useState<Map<string, ResourceSetting>>(new Map());\n\tconst [resources, setResources] = useState<Map<string, Resource>>(new Map());\n\tconst [newId, setNewId] = useState('electromagnetic_matrix');\n\tconst [newRate, setNewRate] = useState(1);\n\tconst [displayFactor, setDisplayFactor] = useState(60);\n\tconst [fractionDigits, setFractionalDigits] = useState(1);\n\tconst sankey = useRef<HTMLDivElement>(null);\n\tconst [nodes, setNodes] = useState<Node[]>([]);\n\tconst [links, setLinks] = useState<Link[]>([]);\n\n\tconst updatePlan = useCallback(\n\t\t(id: string, plan: Partial<Plan>) => setPlans((plans) => new Map(plans.set(id, { ...plans.get(id)!, ...plan }))),\n\t\t[setPlans]\n\t);\n\tconst removePlan = useCallback(\n\t\t(id: string) =>\n\t\t\tsetPlans((plans) => {\n\t\t\t\tplans.delete(id);\n\t\t\t\treturn new Map(plans);\n\t\t\t}),\n\t\t[setPlans]\n\t);\n\n\tconst changeResourceSetting = useCallback(\n\t\t(id: string, newSettings: Partial<ResourceSetting>) =>\n\t\t\tsetSettings((settings) => new Map(settings.set(id, { ...settings.get(id), ...newSettings }))),\n\t\t[setSettings]\n\t);\n\n\tconst formatResourceRate = useCallback((num: number) => (num * displayFactor).toFixed(fractionDigits), [\n\t\tdisplayFactor,\n\t\tfractionDigits\n\t]);\n\n\tuseEffect(() => {\n\t\tconst newResources = new Map<string, Resource>();\n\n\t\tconst planQueue: PlanQueueItem[] = [...plans]\n\t\t\t.filter(([, plan]) => !plan.disabled)\n\t\t\t.map(([planId, plan]) => ({ ...plan, id: planId, implicit: false }));\n\t\tlet i = 0;\n\t\twhile (planQueue.length > 0) {\n\t\t\ti++; // Safety to stop endless loops\n\t\t\tconst plan = planQueue.shift();\n\t\t\tif (!plan || i > 1000) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst recipes = recipesByComponent.get(plan.id)?.asOutput;\n\t\t\tif (!recipes || recipes.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet outputResource = newResources.get(plan.id);\n\t\t\tif (!outputResource) {\n\t\t\t\toutputResource = {\n\t\t\t\t\trecipe: null,\n\t\t\t\t\texternal: false,\n\t\t\t\t\timplicit: true,\n\t\t\t\t\tusedBy: new Map(),\n\t\t\t\t\tuses: new Map()\n\t\t\t\t};\n\t\t\t\tnewResources.set(plan.id, outputResource);\n\t\t\t}\n\n\t\t\tconst setting = settings.get(plan.id);\n\t\t\tconst recipe = recipes.find((r) => r.name === setting?.recipe) || recipes[0];\n\t\t\tif (!outputResource.recipe) {\n\t\t\t\toutputResource.recipe = recipe;\n\t\t\t}\n\n\t\t\tif (setting?.external) {\n\t\t\t\toutputResource.external = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!plan.implicit) {\n\t\t\t\toutputResource.implicit = false;\n\t\t\t\toutputResource.usedBy.set(plan.id, (outputResource.usedBy.get(plan.id) || 0) + plan.rate);\n\t\t\t}\n\n\t\t\tconst outputRatio = recipe.outputs.find((output) => output.id === plan.id)!.amount / recipe.time;\n\n\t\t\tfor (const input of recipe.inputs) {\n\t\t\t\tconst neededRate = (plan.rate / outputRatio) * (input.amount / recipe.time);\n\t\t\t\toutputResource.uses.set(input.id, (outputResource.uses.get(input.id) || 0) + neededRate);\n\n\t\t\t\tlet inputResource = newResources.get(input.id);\n\t\t\t\tif (!inputResource) {\n\t\t\t\t\tinputResource = {\n\t\t\t\t\t\trecipe: null,\n\t\t\t\t\t\texternal: false,\n\t\t\t\t\t\timplicit: true,\n\t\t\t\t\t\tusedBy: new Map(),\n\t\t\t\t\t\tuses: new Map()\n\t\t\t\t\t};\n\t\t\t\t\tnewResources.set(input.id, inputResource);\n\t\t\t\t}\n\n\t\t\t\tinputResource.usedBy.set(plan.id, (inputResource.usedBy.get(plan.id) || 0) + neededRate);\n\n\t\t\t\tif (!outputResource.external && plan.id !== input.id) {\n\t\t\t\t\tplanQueue.push({\n\t\t\t\t\t\tid: input.id,\n\t\t\t\t\t\trate: neededRate,\n\t\t\t\t\t\tdisabled: false,\n\t\t\t\t\t\timplicit: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst newNodes: Node[] = [];\n\t\tconst newLinks: Link[] = [];\n\t\tconst idMap: Map<string, number> = new Map();\n\n\t\tfor (const [resourceId] of newResources) {\n\t\t\tconst id = newNodes.length;\n\t\t\tidMap.set(resourceId, id);\n\t\t\tconst color = randomColor();\n\t\t\tnewNodes.push({ name: resourceId, color });\n\t\t}\n\n\t\tfor (const [resourceId, resource] of newResources) {\n\t\t\tfor (const [link, amount] of resource.usedBy) {\n\t\t\t\tconst source = idMap.get(resourceId);\n\t\t\t\tconst target = idMap.get(link);\n\t\t\t\tif (typeof source !== 'number' || typeof target !== 'number' || source === target) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnewLinks.push({ source, target, value: amount, color: newNodes[source].color });\n\t\t\t}\n\t\t}\n\n\t\tsetNodes(newNodes);\n\t\tsetLinks(newLinks);\n\n\t\tsetResources(newResources);\n\t}, [plans, settings]);\n\n\treturn (\n\t\t<div id=\"main\">\n\t\t\t<h1>Dyson Sphere Program Calculator</h1>\n\n\t\t\t<div id=\"settings\">\n\t\t\t\t<h2>Settings</h2>\n\t\t\t\t<div className=\"settings-item\">\n\t\t\t\t\t<div className=\"settings-item--name\">Rate [s]</div>\n\t\t\t\t\t<div className=\"settings-item--value\">\n\t\t\t\t\t\t<input type=\"number\" value={displayFactor} onChange={(e) => setDisplayFactor(Number(e.target.value))} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"settings-item\">\n\t\t\t\t\t<div className=\"settings-item--name\">Fractional Digits</div>\n\t\t\t\t\t<div className=\"settings-item--value\">\n\t\t\t\t\t\t<input type=\"number\" value={fractionDigits} onChange={(e) => setFractionalDigits(Number(e.target.value))} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div id=\"plan\">\n\t\t\t\t<h2>Planner</h2>\n\t\t\t\t<div className=\"plan-item-header\">\n\t\t\t\t\t<div className=\"plan-item--item\">Item</div>\n\t\t\t\t\t<div className=\"plan-item--rate\">Target rate [1/{displayFactor}s]</div>\n\t\t\t\t\t<div className=\"plan-item--action\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"plan-item\">\n\t\t\t\t\t<div className=\"plan-item--item\">\n\t\t\t\t\t\t<select value={newId} onChange={(e) => setNewId(e.target.value)}>\n\t\t\t\t\t\t\t{components.map((component) => (\n\t\t\t\t\t\t\t\t<option key={component.id} value={component.id}>\n\t\t\t\t\t\t\t\t\t{component.id}\n\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"plan-item--rate\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tplaceholder=\"Target rate\"\n\t\t\t\t\t\t\tvalue={newRate * displayFactor}\n\t\t\t\t\t\t\tonChange={(e) => setNewRate(Number(e.target.value) / displayFactor)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"plan-item--action\">\n\t\t\t\t\t\t<button onClick={() => updatePlan(newId, { rate: newRate })}>Add</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{[...plans].map(([planId, plan]) => (\n\t\t\t\t\t<div className={'plan-item' + (plan.disabled ? ' disabled' : '')} key={planId}>\n\t\t\t\t\t\t<div className=\"plan-item--item\">{planId}</div>\n\t\t\t\t\t\t<div className=\"plan-item--rate\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tplaceholder=\"Target rate\"\n\t\t\t\t\t\t\t\tvalue={plan.rate * displayFactor}\n\t\t\t\t\t\t\t\tonChange={(e) => updatePlan(planId, { rate: Number(e.target.value) / displayFactor })}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"plan-item--action\">\n\t\t\t\t\t\t\t<button onClick={() => updatePlan(planId, { disabled: !plan.disabled })}>\n\t\t\t\t\t\t\t\t{plan.disabled ? 'Enable' : 'Disable'}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button onClick={() => removePlan(planId)}>Remove</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\n\t\t\t<div id=\"sankey\" ref={sankey}>\n\t\t\t\t<h2>Sankey</h2>\n\t\t\t\t{nodes.length > 0 && (\n\t\t\t\t\t<Sankey\n\t\t\t\t\t\tnodePadding={20}\n\t\t\t\t\t\tnodes={nodes}\n\t\t\t\t\t\tlinks={links}\n\t\t\t\t\t\twidth={sankey.current?.getBoundingClientRect().width || 0}\n\t\t\t\t\t\theight={800}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t<div id=\"resources\">\n\t\t\t\t<h2>Resources</h2>\n\t\t\t\t<div className=\"resources-item-header\">\n\t\t\t\t\t<div className=\"resources-item--action\"></div>\n\t\t\t\t\t<div className=\"resources-item--item\">Item</div>\n\t\t\t\t\t<div className=\"resources-item--rate\">Rate [1/{displayFactor}s]</div>\n\t\t\t\t\t<div className=\"resources-item--rate\">Machines</div>\n\t\t\t\t\t<div className=\"resources-item--uses\">Uses</div>\n\t\t\t\t\t<div className=\"resources-item--usedby\">Used By</div>\n\t\t\t\t</div>\n\t\t\t\t{[...resources]\n\t\t\t\t\t.filter(([, resource]) => resource.usedBy.size > 0)\n\t\t\t\t\t.map(([resourceId, resource]) => {\n\t\t\t\t\t\tconst uses = [...resource.uses.entries()].map((e) => ({ id: e[0], rate: e[1] }));\n\t\t\t\t\t\tconst usedBy = [...resource.usedBy.entries()].map((e) => ({ id: e[0], rate: e[1] }));\n\t\t\t\t\t\tconst rate = usedBy.reduce((acc, res) => acc + res.rate, 0);\n\t\t\t\t\t\tconst recipes = recipesByComponent.get(resourceId)?.asOutput;\n\t\t\t\t\t\tconst outputRatio = resource.recipe\n\t\t\t\t\t\t\t? resource.recipe.outputs.find((output) => output.id === resourceId)!.amount / resource.recipe.time\n\t\t\t\t\t\t\t: 1;\n\n\t\t\t\t\t\tconst className =\n\t\t\t\t\t\t\t'resources-item' + (!resource.implicit ? ' explicit' : '') + (resource.external ? ' external' : '');\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className={className} key={resourceId}>\n\t\t\t\t\t\t\t\t<div className=\"resources-item--action\">\n\t\t\t\t\t\t\t\t\t{resource.implicit && (\n\t\t\t\t\t\t\t\t\t\t<button onClick={() => changeResourceSetting(resourceId, { external: !resource.external })}>\n\t\t\t\t\t\t\t\t\t\t\t{resource.external ? 'Produce Locally' : 'Produce Externally'}\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"resources-item--item\">\n\t\t\t\t\t\t\t\t\t<div>{resourceId}</div>\n\t\t\t\t\t\t\t\t\t{recipes && recipes.length > 1 && (\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={resource.recipe?.name}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => changeResourceSetting(resourceId, { recipe: e.target.value })}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{recipes.map((recipe) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value={recipe.name} key={recipe.name}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{recipe.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"resources-item--rate\">{formatResourceRate(rate)}</div>\n\t\t\t\t\t\t\t\t<div className=\"resources-item--machines\">\n\t\t\t\t\t\t\t\t\t{resource.recipe && `${(rate / outputRatio).toFixed(1)}x ${resource.recipe.machine}`}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"resources-item--uses\">\n\t\t\t\t\t\t\t\t\t{uses.map((use) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={use.id}\n\t\t\t\t\t\t\t\t\t\t\tclassName={'resources-item--uses-item' + (use.id === resourceId ? ' recursive' : '')}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--uses-item--rate\">{formatResourceRate(use.rate)}</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--uses-item--name\">\n\t\t\t\t\t\t\t\t\t\t\t\t{use.id}\n\t\t\t\t\t\t\t\t\t\t\t\t{use.id === resourceId && ' 🔁'}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"resources-item--usedby\">\n\t\t\t\t\t\t\t\t\t{!resource.implicit && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--usedby-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--usedby-item--rate\">\n\t\t\t\t\t\t\t\t\t\t\t\t{formatResourceRate(usedBy.find((usedBy) => usedBy.id === resourceId)!.rate)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--usedby-item--name\">Planner</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{usedBy\n\t\t\t\t\t\t\t\t\t\t.filter((usedBy) => usedBy.id !== resourceId)\n\t\t\t\t\t\t\t\t\t\t.map((usedBy) => (\n\t\t\t\t\t\t\t\t\t\t\t<div key={usedBy.id} className=\"resources-item--usedby-item\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--usedby-item--rate\">{formatResourceRate(usedBy.rate)}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"resources-item--usedby-item--name\">{usedBy.id}</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t</div>\n\n\t\t\t<div id=\"recipes\">\n\t\t\t\t<h2>Recipes</h2>\n\t\t\t\t<div className=\"recipes-item-header\">\n\t\t\t\t\t<div className=\"recipes-item--name\">Name</div>\n\t\t\t\t\t<div className=\"recipes-item--inputs\">Inputs [1/{displayFactor}s]</div>\n\t\t\t\t\t<div className=\"recipes-item--time\">Time [s]</div>\n\t\t\t\t\t<div className=\"recipes-item--outputs\">Outputs [1/{displayFactor}s]</div>\n\t\t\t\t</div>\n\t\t\t\t{recipes.map((recipe, i) => (\n\t\t\t\t\t<div key={i} className=\"recipes-item\">\n\t\t\t\t\t\t<div className=\"recipes-item--name\">{recipe.name}</div>\n\t\t\t\t\t\t<div className=\"recipes-item--inputs\">\n\t\t\t\t\t\t\t{recipe.inputs.map((input) => (\n\t\t\t\t\t\t\t\t<div key={input.id} className=\"recipes-item--inputs-item\">\n\t\t\t\t\t\t\t\t\t<div className=\"recipes-item--inputs-item--amount\">\n\t\t\t\t\t\t\t\t\t\t{((input.amount * displayFactor) / recipe.time).toFixed(fractionDigits)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"recipes-item--inputs-item--name\">{input.id}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"recipes-item--time\">{recipe.time}</div>\n\t\t\t\t\t\t<div className=\"recipes-item--outputs\">\n\t\t\t\t\t\t\t{recipe.outputs.map((output) => (\n\t\t\t\t\t\t\t\t<div key={output.id} className=\"recipes-item--outputs-item\">\n\t\t\t\t\t\t\t\t\t<div className=\"recipes-item--outputs-item--amount\">\n\t\t\t\t\t\t\t\t\t\t{((output.amount * displayFactor) / recipe.time).toFixed(fractionDigits)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"recipes-item--outputs-item--name\">{output.id}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}